# نقاشی بکش لویی — نسخه‌ی کلاینت/سرور (بخش اول + دوم)

این پروژه یک اپ ساده‌ی React برای کشیدن شکل‌ها روی بومه؛
در «بخش دوم» امکان ذخیره/بازیابی نقاشی روی سرور هم اضافه شده.

## امکانات
- سایدبار **Tools** با دکمه‌های بزرگ و رنگی (دایره آبی، مربع سبز، مثلث صورتی)
- کلیک روی بوم → اضافه شدن شکل انتخاب‌شده در همان نقطه
- دوبار کلیک روی شکل → حذف همان شکل
- شمارنده‌ی تعداد هر نوع شکل در پایین
- Import/Export به JSON در سمت کلاینت
- انتخاب کاربر (alice / bob / carol) و **Save / Load** از سرور برای هر کاربر (هر کاربر یک نقاشی)

---

## پیش‌نیاز
- Node.js نسخه‌ی 20.19+ یا 22.12+ (پیشنهادی 22)
- npm برای اجرای کلاینت (Vite)

---

## راه‌اندازی سریع

### ۱) سرور (بدون نصب پکیج)
- وارد فولدر `server/` شوید و اجرا کنید:

    node index.js

- اگر ترجیح می‌دهید با npm اجرا کنید (نصب لازم نیست):

    npm start

- در اولین اجرا، پوشه‌ی `server/data/` خودکار ساخته می‌شود و فایل‌های `users.json` و `paintings.json` ایجاد می‌گردد.

### ۲) کلاینت (React + Vite)
- در ریشه‌ی پروژه:

    npm install
    npm run dev

- بعد در مرورگر باز کنید: `http://localhost:5173/`

---

## طرز استفاده
1) از سایدبار (**Tools**) یکی از ابزارها را انتخاب کنید: دایره (آبی) / مربع (سبز) / مثلث (صورتی).
2) روی بوم سفید کلیک کنید تا شکل همان‌جا اضافه شود.
3) برای حذف، روی همان شکل **دوبار کلیک** کنید.
4) پایین صفحه تعداد هر نوع شکل را می‌بینید.
5) برای ذخیره‌ی محلی/اشتراک‌گذاری، از **Export** (دانلود JSON) و **Import** (بارگذاری JSON) استفاده کنید.
6) برای ذخیره‌ی سمت سرور:
   - از لیست کاربر یکی از `alice` / `bob` / `carol` را انتخاب کنید.
   - **Save** را بزنید تا نقاشی برای همان کاربر ذخیره شود.
   - با **Load** نقاشی ذخیره‌شده‌ی همان کاربر برگردانده می‌شود.

---

## API سرور (خلاصه)
- `GET /api/health` → تست سلامت.
- `GET /api/users` → لیست کاربران seed.
- `POST /api/login` با بدنه‌ی `{ "username": "alice" }` → برمی‌گرداند `{ id, username }`.
- `GET /api/painting` با هدر `x-user-id: <id>` → نقاشی کاربر (اگر نباشد، خالی برمی‌گردد).
- `POST /api/painting` با هدر `x-user-id` و بدنه‌ی `{ "title": "...", "shapes": [...] }` → ذخیره برای همان کاربر.

(سرور با ماژول‌های داخلی Node نوشته شده و نیاز به نصب پکیج ندارد؛ CORS برای `http://localhost:5173` باز است.)

---

## فرمت JSON نقاشی (Import/Export/Server)

    {
      "title": "My Painting",
      "shapes": [
        { "id": "uuid-or-number", "type": "circle|square|triangle", "x": 120, "y": 240 }
      ]
    }

---

## توضیح کوتاه درباره ساختار کد
- `App.jsx` حالت‌های اصلی (`title`, `selectedShape`, `shapes`, `user`) را نگه می‌دارد و بین Header/Sidebar/Canvas/Footer پخش می‌کند.
- `Header.jsx` شامل عنوان، Import/Export، انتخاب کاربر و دکمه‌های Save/Load است.
- `Sidebar.jsx` ابزارها را نمایش می‌دهد.
- `Canvas.jsx` با کلیک شکل جدید اضافه می‌کند؛ حذف با دوبار کلیک در `Shape.jsx`.
- سمت سرور: `index.js` (REST ساده)، `store.js` (ذخیره‌ی فایل‌محور)، `paintingModel.js` (ساختار Painting).
